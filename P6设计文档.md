# P6设计文档

主体部件沿用p4，p5

这篇设计主要说明三个设计：1，四级寄存器；2，冲突处理，3，指令分类

## 四级寄存器：

D: 驱动GRF读出及EXT扩展

E：驱动ALU

M：驱动DM读写

W：驱动GRF写入

## 冲突处理

转发及阻塞都在

冲突包括：

D：beq需要转发（zero信号）

​       jal会将pc+8并入WB，并替换rd信号

​       jr需要转发（来自后三级）

E：ALU写入转发

M：DM写入数据转发（原本来自GRF_r2，现在有可能来自W写入）

​        DMadd转发已在E级解决

W：不接收转发

## 指令分类

分为如下几类：

rr运算：寄存器之间运算，只经过ALU

ri运算：寄存器与立即数

纯i运算：立即数操作，不过ALU

MD运算：过乘法器

跳转

访存



按照每种特性写出第一条模板，就可解决一类指令



## 思考题

1，乘法原件需要多个周期或者长时间执行，会严重影响流水线效率，hi，lo也是一样，如果直接存入寄存器堆则每个乘除指令都要延迟多个周期

2，循环位移和加减实现的

3，有busy信号，且当前D级信号需要使用MD模块就阻塞

4，可操作性高，用一个信号实现了三个不同存储指令的使能与位置指示

5，不是，其实传入了一整个字，没想明白，感觉都是按字节写的不如按字写

6，抽象指令为一类指令，并减少独立信号，特点：每个部件并不关心指令是什么，只关心自己的信号有没有激活

7，与p5大致相同，新增了MD原件的冲突，样例也围绕这几个进行构建

8，策略，将新指令与之前p5时的测试样例进行一一组合，就可以保证完全覆盖连续两条的冲突；对于间隔指令冲突，只能逐一思考

​       

