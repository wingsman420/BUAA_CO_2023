# P5设计文档

主体部件沿用p4

这篇设计主要说明两个设计：1，四级寄存器；2，冲突处理

## 四级寄存器：

D: 驱动GRF读出及EXT扩展

E：驱动ALU

M：驱动DM读写

W：驱动GRF写入

## 冲突处理

转发及阻塞都在

冲突包括：

D：beq需要转发（zero信号）

​       jal会将pc+8并入WB，并替换rd信号

​       jr需要转发（来自后三级）

E：ALU写入转发

M：DM写入数据转发（原本来自GRF_r2，现在有可能来自W写入）

​        DMadd转发已在E级解决

W：不接收转发

## 思考题

1，add beq 这个序列本来若在E级转发，不需要阻塞一周期，但提前转发要阻塞

2，提升效率，没有延迟槽意味着跳转指令后要阻塞一周期

3，为了节省时间，来自功能部件意味着组合逻辑部分时间加长，这不符合五级流水线设计思想

4，来自W级的数据在同一时间被读出，所以就改变读出数据的来源，即内部转发

5，见上文

6，j类：

​      类beq：在block块中D级转发处增加信号

​      类jal：合并写入多一个通路

​      类jr ：D级转发通路分支

 

​      i类：

​       类ori：

​       ALU中增加新算法

​       类lui：

​       use—imm—only加通路

​      

​       r类：

​       DM相关：

​       ALU加新算法，且修改DM读取方式

​       类add（纯计算）

​       只动ALU就差不多了

7：译码器和之前一样



​       

